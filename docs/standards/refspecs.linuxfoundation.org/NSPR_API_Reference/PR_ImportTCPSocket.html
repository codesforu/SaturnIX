<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" >
 <head>
    <script type="text/javascript">var _starttime = new Date().getTime();</script>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>PR_ImportTCPSocket</title>
</head>

<body>
          <div class="pageTitle">
            <h1 id="title">PR ImportTCPSocket</h1>
      </div>
    				
      <div id="page-update" class="pageStatus  hastoc">
 			   			</div>

<p>Imports a native TCP socket into NSPR.</p>
<div id="section_1"><a id="Syntax"><h3 class="editable">Syntax</h3>
<pre class="eval">#include &quot;private/pprio.h&quot;

PRFileDesc* PR_ImportTCPSocket(PROsfd osfd);
</pre>
</div><div id="section_2"><a id="Parameters"><h3 class="editable">Parameters</h3>
<p>The function has the following parameters:</p>
<dl><dt><code>osfd</code> </dt><dd>The native file descriptor for the TCP socket to import. On POSIX systems, this is an <code>int</code>. On Windows, this is a <code>SOCKET</code>.</dd></dl>
</div><div id="section_3"><a id="Returns"><h3 class="editable">Returns</h3>
<p>The function returns one of the following values:</p>
<ul> <li>Upon successful completion, a pointer to the <code>PRFileDesc</code> object created for the newly imported native TCP socket.</li> <li>If the import of the native TCP socket failed, <code>NULL</code>.</li>
</ul>
</div><div id="section_4"><a id="Description"><h3 class="editable">Description</h3>
<p>A native TCP socket <code>osfd</code> can be imported into NSPR with <code>PR_ImportTCPSocket</code>. The caller gives up control of the native TCP socket <code>osfd</code> and should use the <code>PRFileDesc*</code> returned by <code>PR_ImportTCPSocket</code> instead.</p>
<p>Although <code>PR_ImportTCPSocket</code> is a supported function, it is declared in <code>&quot;private/pprio.h&quot;</code> to stress the fact that this function depends on the internals of the NSPR implementation. The caller needs to understand what NSPR will do to the native file descriptor and make sure that NSPR can use the native file descriptor successfully.</p>
<p>For example, on POSIX systems, NSPR will put the native file descriptor (an <code>int</code>) in non-blocking mode by calling <code>fcntl</code> to set the <code>O_NONBLOCK</code> file status flag on the native file descriptor, and then NSPR will call socket functions such as <code>recv</code>, <code>send</code>, and <code>poll</code> on the native file descriptor. The caller must not do anything to the native file descriptor before the <code>PR_ImportTCPSocket</code> call that will prevent the native file descriptor from working in non-blocking mode.</p>
</div><div id="section_5"><a id="Warning"><h3 class="editable">Warning</h3>
<p>In theory, code that uses <code>PR_ImportTCPSocket</code> may break when NSPR's implementation changes. In practice, this is unlikely to happen because NSPR's implementation has been stable for years and because of NSPR's strong commitment to backward compatibility. Using <code>PR_ImportTCPSocket</code> is much more convenient than writing an NSPR I/O layer that wraps your native TCP sockets. Of course, it is best if you just use <code><a class="internal" rel="internal" href="https://developer.mozilla.org/En/PR_OpenTCPSocket">PR_OpenTCPSocket</code> or <code><a class="internal" rel="internal" href="https://developer.mozilla.org/en/PR_NewTCPSocket">PR_NewTCPSocket</code>. If you are not sure whether <code>PR_ImportTCPSocket</code> is right for you, please ask in the mozilla.dev.tech.nspr newsgroup.</p></div><hr />
</body>
</html>
