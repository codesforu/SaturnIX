<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>backtrace, backtrace_symbols, backtrace_symbols_fd</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="Linux Standard Base Core Specification, Generic Part"
HREF="book1.html"><LINK
REL="UP"
TITLE="Interface Definitions for libc"
HREF="libcman.html"><LINK
REL="PREVIOUS"
TITLE="asprintf"
HREF="baselib-asprintf.html"><LINK
REL="NEXT"
TITLE="basename"
HREF="baselib-basename-3.html"></HEAD
><BODY
CLASS="REFENTRY"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Linux Standard Base Core Specification, Generic Part</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="baselib-asprintf.html"
ACCESSKEY="P"
>&#60;&#60;&#60; Previous</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="baselib-basename-3.html"
ACCESSKEY="N"
>Next &#62;&#62;&#62;</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><H1
><A
NAME="BASELIB-BACKTRACE-1"
></A
>backtrace, backtrace_symbols, backtrace_symbols_fd</H1
><DIV
CLASS="REFNAMEDIV"
><A
NAME="AEN12638"
></A
><H2
>Name</H2
>backtrace, backtrace_symbols, backtrace_symbols_fd&nbsp;--&nbsp;runtime stack back tracing</DIV
><DIV
CLASS="REFSYNOPSISDIV"
><A
NAME="AEN12647"
></A
><H2
>Synopsis</H2
><DIV
CLASS="FUNCSYNOPSIS"
><P
></P
><A
NAME="AEN12648"
></A
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="FUNCSYNOPSISINFO"
>#include &#60;execinfo.h&#62;</PRE
></TD
></TR
></TABLE
><P
><CODE
><CODE
CLASS="FUNCDEF"
>int
<TT
CLASS="FUNCTION"
>backtrace</TT
></CODE
>(void **<TT
CLASS="PARAMETER"
><I
>array</I
></TT
>, int <TT
CLASS="PARAMETER"
><I
>size</I
></TT
>);</CODE
></P
><P
><CODE
><CODE
CLASS="FUNCDEF"
>char **<TT
CLASS="FUNCTION"
>backtrace_symbols</TT
></CODE
>(void *const *<TT
CLASS="PARAMETER"
><I
>array</I
></TT
>, int <TT
CLASS="PARAMETER"
><I
>size</I
></TT
>);</CODE
></P
><P
><CODE
><CODE
CLASS="FUNCDEF"
>void
<TT
CLASS="FUNCTION"
>backtrace_symbols_fd</TT
></CODE
>(void *const *<TT
CLASS="PARAMETER"
><I
>array</I
></TT
>, int <TT
CLASS="PARAMETER"
><I
>size</I
></TT
>, int <TT
CLASS="PARAMETER"
><I
>fd</I
></TT
>);</CODE
></P
><P
></P
></DIV
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="AEN12673"
></A
><H2
>Description</H2
><P
><TT
CLASS="FUNCTION"
>backtrace()</TT
>
obtains a backtrace for the current thread as a list of
pointers filled in to <TT
CLASS="PARAMETER"
><I
>array</I
></TT
>.
The <TT
CLASS="PARAMETER"
><I
>size</I
></TT
> parameter describes the
number of elements that will fit into <TT
CLASS="PARAMETER"
><I
>array</I
></TT
>,
<TT
CLASS="FUNCTION"
>backtrace()</TT
> will truncate the list if 
necessary.
A backtrace is a list of currently active function
calls in a thread; each function call allocates a new
stack frame and <TT
CLASS="FUNCTION"
>backtrace()</TT
>
obtains the return address from each stack frame.</P
><P
><TT
CLASS="FUNCTION"
>backtrace_symbols()</TT
>
translates the information obtained from
<TT
CLASS="FUNCTION"
>backtrace()</TT
> into an array of strings.
<TT
CLASS="PARAMETER"
><I
>array</I
></TT
> is a pointer to an
array of addresses as obtained from <TT
CLASS="FUNCTION"
>backtrace()</TT
>.
<TT
CLASS="PARAMETER"
><I
>size</I
></TT
> is the number of entries in
<TT
CLASS="PARAMETER"
><I
>array</I
></TT
>, and should be the return
value of the call to
<TT
CLASS="FUNCTION"
>backtrace()</TT
>.
The strings contain the function name if it can be determined,
a hedxadecimal offset into the function, and the actual return
address in hexadecimal. Note that the pointer returned by
<TT
CLASS="FUNCTION"
>backtrace_symbols()</TT
> is obtained by an
internal call to <TT
CLASS="FUNCTION"
>malloc()</TT
> and should be
freed when no longer needed.</P
><P
><TT
CLASS="FUNCTION"
>backtrace_symbols_fd()</TT
>
performs the same transformation as 
<TT
CLASS="FUNCTION"
>backtrace_symbols()</TT
> given the
same argument pair
<TT
CLASS="PARAMETER"
><I
>array</I
></TT
>, <TT
CLASS="PARAMETER"
><I
>size</I
></TT
>, but writes
the strings to the file descriptor contained in <TT
CLASS="PARAMETER"
><I
>fd</I
></TT
>.
This avoids the allocation of string space.</P
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="AEN12698"
></A
><H2
>Return Value</H2
><P
><TT
CLASS="FUNCTION"
>backtrace()</TT
> returns the number of entries
placed into <TT
CLASS="PARAMETER"
><I
>array</I
></TT
>, no more than
<TT
CLASS="PARAMETER"
><I
>size</I
></TT
>.  If the value is less than
<TT
CLASS="PARAMETER"
><I
>size</I
></TT
>, the full backtrace was returned;
else it may have been truncated.</P
><P
>On success, <TT
CLASS="FUNCTION"
>backtrace_symbols()</TT
> returns a pointer to
an array of strings, which will have <TT
CLASS="PARAMETER"
><I
>size</I
></TT
> entries.
On error, <TT
CLASS="LITERAL"
>NULL</TT
> is returned.</P
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="AEN12709"
></A
><H2
>Errors</H2
><P
>No errors are defined for these functions.  If
<TT
CLASS="FUNCTION"
>backtrace_symbols_fd()</TT
> fails,
it will be due to a failure in the call to <TT
CLASS="FUNCTION"
>malloc()</TT
>,
and <CODE
CLASS="VARNAME"
>errno</CODE
> will be set accordingly.</P
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="AEN12715"
></A
><H2
>Notes</H2
><P
>The ability to obtain useful backtrace information, in particular
function names, is dependent on a number of factors at the time
of program construction, such as compiler optimization options.
Even if the program itself is constructed so as to make symbols
visible, the call trace may descend into system libraries which
have not been so constructed.</P
><P
>Inlined functions do not have stack frames, and functions
declared as static are not exposed and so will not be available
in the backtrace.</P
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="AEN12719"
></A
><H2
>See Also</H2
><P
><TT
CLASS="FUNCTION"
>malloc()</TT
></P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="baselib-asprintf.html"
ACCESSKEY="P"
>&#60;&#60;&#60; Previous</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="book1.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="baselib-basename-3.html"
ACCESSKEY="N"
>Next &#62;&#62;&#62;</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>asprintf</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="libcman.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>basename</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>